(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-03cd3daa"],{"69f8":function(e,t,o){"use strict";o.d(t,"a",(function(){return r})),o.d(t,"b",(function(){return i})),o.d(t,"c",(function(){return l})),o.d(t,"d",(function(){return n})),o.d(t,"e",(function(){return c}));var a=o("b775");function r(e){return Object(a["a"])({url:"/v1/print/loadMetaData",method:"get",params:e})}function i(e){return Object(a["a"])({url:"/v1/print/preview",method:"post",headers:{"Content-Type":"application/json"},data:e})}function l(e){return Object(a["a"])({url:"/v1/print/print",method:"post",headers:{"Content-Type":"application/json"},data:e})}function n(e){return Object(a["a"])({url:"/v1/zplPrint/preparePrint",method:"post",headers:{"Content-Type":"application/json"},data:e})}function c(e){return Object(a["a"])({url:"/v1/zplPrint/print",method:"post",headers:{"Content-Type":"application/json"},data:e})}},"766c":function(e,t,o){},"88b5":function(e,t,o){"use strict";o("766c")},efe5:function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"app-container"},[o("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[o("el-form-item",{attrs:{label:"供应商"}},[o("el-input",{staticStyle:{width:"35%"},attrs:{disabled:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),o("el-form-item",{attrs:{label:"模板",prop:"templateId"}},[o("el-select",{staticStyle:{width:"25%"},attrs:{placeholder:"选择模板",filterable:!0,"value-key":"id"},on:{change:e.changeTemplate},model:{value:e.form.templateId,callback:function(t){e.$set(e.form,"templateId",t)},expression:"form.templateId"}},e._l(e.templates,(function(e){return o("el-option",{key:e.id,attrs:{label:e.title,value:e}})})),1)],1),e.enableOrderCode?o("el-form-item",{attrs:{label:"订单号"}},[o("el-input",{staticStyle:{width:"35%"},model:{value:e.form.orderCode,callback:function(t){e.$set(e.form,"orderCode",t)},expression:"form.orderCode"}})],1):e._e(),o("el-form-item",{attrs:{label:"机器编号",prop:"machineName"}},[o("el-cascader",{staticStyle:{width:"25%"},attrs:{options:e.machines,props:{expandTrigger:"hover"}},model:{value:e.form.machineName,callback:function(t){e.$set(e.form,"machineName",t)},expression:"form.machineName"}})],1),o("el-form-item",{attrs:{label:"接单卡号",prop:"orderNo"}},[o("el-select",{staticStyle:{width:"25%"},attrs:{placeholder:"选择接单卡号",filterable:!0,"value-key":"id"},on:{change:e.orderOptionChange},model:{value:e.form.orderNo,callback:function(t){e.$set(e.form,"orderNo",t)},expression:"form.orderNo"}},e._l(e.commodities,(function(e){return o("el-option",{key:e.id,attrs:{label:e.col1,value:e}})})),1)],1),o("el-form-item",{attrs:{label:"品名"}},[o("el-input",{staticStyle:{width:"35%"},attrs:{disabled:""},model:{value:e.form.productCode,callback:function(t){e.$set(e.form,"productCode",t)},expression:"form.productCode"}})],1),o("el-form-item",{attrs:{label:"产品名"}},[o("el-input",{staticStyle:{width:"35%"},attrs:{disabled:""},model:{value:e.form.productName,callback:function(t){e.$set(e.form,"productName",t)},expression:"form.productName"}})],1),o("el-form-item",{attrs:{label:"规格"}},[o("el-input",{staticStyle:{width:"35%"},attrs:{disabled:""},model:{value:e.form.specification,callback:function(t){e.$set(e.form,"specification",t)},expression:"form.specification"}})],1),o("el-form-item",{attrs:{label:"纸箱编号"}},[o("el-input",{staticStyle:{width:"35%"},attrs:{disabled:""},model:{value:e.form.boxCode,callback:function(t){e.$set(e.form,"boxCode",t)},expression:"form.boxCode"}})],1),o("el-form-item",{attrs:{label:"SAP代码"}},[o("el-input",{staticStyle:{width:"35%"},attrs:{disabled:""},model:{value:e.form.sapCode,callback:function(t){e.$set(e.form,"sapCode",t)},expression:"form.sapCode"}})],1),o("el-form-item",{attrs:{label:"日期",prop:"selectedDate"}},[o("el-col",{attrs:{span:24}},[o("el-date-picker",{staticStyle:{width:"35%"},attrs:{type:"date",format:"yyyy年MM月dd日","value-format":"yyyyMMdd",placeholder:"选择日期"},model:{value:e.form.selectedDate,callback:function(t){e.$set(e.form,"selectedDate",t)},expression:"form.selectedDate"}})],1)],1),o("el-form-item",{attrs:{label:"箱容量"}},[o("el-input",{staticClass:"input-with-select",staticStyle:{width:"35%"},model:{value:e.form.capacity,callback:function(t){e.$set(e.form,"capacity",t)},expression:"form.capacity"}},[o("el-select",{staticStyle:{width:"100px","padding-left":"6px"},attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:e.form.capacityLabel,callback:function(t){e.$set(e.form,"capacityLabel",t)},expression:"form.capacityLabel"}},[o("el-option",{attrs:{label:"枚/卷",value:"枚/卷"}}),o("el-option",{attrs:{label:"枚/箱",value:"枚/箱"}})],1)],1)],1),o("el-form-item",{attrs:{label:"起始页数"}},[o("el-input-number",{staticStyle:{width:"150px"},attrs:{step:1,size:"medium",min:1,max:5e3},model:{value:e.form.startIndex,callback:function(t){e.$set(e.form,"startIndex",t)},expression:"form.startIndex"}})],1),o("el-form-item",{attrs:{label:"结束页数",prop:"printCount"}},[o("el-input-number",{staticStyle:{width:"150px"},attrs:{step:1,size:"medium",min:1,max:5e3},model:{value:e.form.printCount,callback:function(t){e.$set(e.form,"printCount",t)},expression:"form.printCount"}})],1),o("el-form-item",{attrs:{label:"打印布局"}},[o("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"选择机器编号","value-key":"value"},model:{value:e.form.printType,callback:function(t){e.$set(e.form,"printType",t)},expression:"form.printType"}},e._l(e.printTypeOptions,(function(e){return o("el-option",{key:e.id,attrs:{label:e.label,value:e.value}})})),1)],1),o("el-form-item",[o("el-col",{attrs:{span:2}}),o("el-col",{attrs:{span:2}},[o("el-button",{attrs:{icon:"el-icon-printer",type:"primary"},on:{click:function(t){return e.printPdf("form")}}},[e._v("打印")])],1)],1)],1),o("el-dialog",{staticStyle:{padding:"0px 8px"},attrs:{title:"预览",visible:e.previewDialogVisible,"close-on-click-modal":!1,"before-close":e.beforeClosePreviewDialog,center:!0},on:{"update:visible":function(t){e.previewDialogVisible=t}}},[o("div",{staticClass:"previewContainer",domProps:{innerHTML:e._s(e.templateHtml)}})])],1)},r=[],i=(o("a15b"),o("ac1f"),o("5319"),o("69f8")),l=o("add5"),n=o.n(l),c={data:function(){var e=this,t=function(t,o,a){""===o||o<e.form.startIndex?a(new Error("结束页数需要大于起始页数")):a()},o=(new Date).toISOString().split("T")[0].split("-").join("");return console.log("today:"+o),{form:{name:"上海福助工业有限公司",orderNo:"",machineName:[],selectedDate:o,startIndex:1,printCount:1,capacity:"",productCode:"",productName:"",boxCode:"",sapCode:"",specification:"",templateId:null,printType:0,orderCode:"",capacityLabel:"枚/卷"},templateHtml:"",templateContent:"",p1CodeFontSize:-1,p2CodeFontSize:-1,enableOrderCode:!1,rules:{machineName:[{required:!0,message:"请输入机器编号",trigger:"blur"}],orderNo:[{required:!0,message:"请选择接单卡号",trigger:"change"}],templateId:[{required:!0,message:"请选择模板",trigger:"change"}],printCount:[{required:!0,message:"请输入结束页数",trigger:"change"},{validator:t,trigger:"change"}],selectedDate:[{required:!0,message:"请选择日期",trigger:"change"}]},printTypeOptions:[{label:"每页4个(2x2)",value:0,id:0},{label:"每页6个(2x3)",value:1,id:1}],commodities:[],machines:[],templates:[],previewDialogVisible:!1}},created:function(){console.log("created"),this.loadMetaData()},methods:{printPdf:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;var o={templateContent:t.templateContent,specification:t.form.specification,machineCode:t.form.machineName[1],selectedDate:t.form.selectedDate,startIndex:t.form.startIndex,printCount:t.form.printCount,capacity:t.form.capacity?t.form.capacity+" "+t.form.capacityLabel:"",sapCode:t.form.sapCode,productCode:t.form.productCode,productName:t.form.productName,printType:t.form.printType,p1CodeFontSize:t.p1CodeFontSize,p2CodeFontSize:t.p2CodeFontSize,orderCode:t.form.orderCode};Object(i["c"])(o).then((function(e){var t=e.data;n()({printable:t,type:"pdf",showModal:!0,base64:!0,modalMessage:"正在生成待打印的内容"})}))}))},onPreview:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;var o={templateContent:t.templateContent,specification:t.form.specification,machineCode:t.form.machineName[1],selectedDate:t.form.selectedDate,startIndex:t.form.startIndex,printCount:t.form.printCount,capacity:t.form.capacity?t.form.capacity+" "+t.form.capacityLabel:"",sapCode:t.form.sapCode,productCode:t.form.productCode,productName:t.form.productName,p1CodeFontSize:t.p1CodeFontSize,p2CodeFontSize:t.p2CodeFontSize};Object(i["b"])(o).then((function(e){t.previewDialogVisible=!0,t.templateHtml=e.data}))}))},beforeClosePreviewDialog:function(){console.log("call before close dialog"),this.previewDialogVisible=!1},changeTemplate:function(e){this.templateContent=e.content,this.p1CodeFontSize=e.p1CodeFontSize,this.p2CodeFontSize=e.p2CodeFontSize,this.enableOrderCode=e.enableOrderCode,-1!=e.title.indexOf("卷")?this.form.capacityLabel="枚/卷":-1!=e.title.indexOf("箱")&&(this.form.capacityLabel="枚/箱")},orderOptionChange:function(e){var t=null==e.col6?"":e.col6;this.form.capacity=t.replace(/枚\/卷/i,"").replace(/枚\/箱/i,""),this.form.productName=e.col4,this.form.productCode=e.col3,this.form.sapCode=e.col2,this.form.boxCode=e.col7,this.form.specification=e.col5},loadMetaData:function(){var e=this;this.listLoading=!0;var t={type:"common"};Object(i["a"])(t).then((function(t){e.commodities=t.data.commodities,e.machines=t.data.machines,e.templates=t.data.templates}))}}},s=c,d=(o("88b5"),o("2877")),p=Object(d["a"])(s,a,r,!1,null,null,null);t["default"]=p.exports}}]);