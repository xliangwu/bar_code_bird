(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f311326e"],{"3c62":function(e,t,r){"use strict";r("aa23")},"69f8":function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return n})),r.d(t,"e",(function(){return s}));var a=r("b775");function o(e){return Object(a["a"])({url:"/v1/print/loadMetaData",method:"get",params:e})}function i(e){return Object(a["a"])({url:"/v1/print/preview",method:"post",headers:{"Content-Type":"application/json"},data:e})}function l(e){return Object(a["a"])({url:"/v1/print/print",method:"post",headers:{"Content-Type":"application/json"},data:e})}function n(e){return Object(a["a"])({url:"/v1/zplPrint/preparePrint",method:"post",headers:{"Content-Type":"application/json"},data:e})}function s(e){return Object(a["a"])({url:"/v1/zplPrint/print",method:"post",headers:{"Content-Type":"application/json"},data:e})}},"796a":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[r("el-form-item",{attrs:{label:"供应商"}},[r("el-input",{staticStyle:{width:"35%"},attrs:{disabled:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),r("el-form-item",{attrs:{label:"模板",prop:"templateId"}},[r("el-select",{staticStyle:{width:"25%"},attrs:{placeholder:"选择模板",filterable:!0,"value-key":"id"},on:{change:e.changeTemplate},model:{value:e.form.templateId,callback:function(t){e.$set(e.form,"templateId",t)},expression:"form.templateId"}},e._l(e.templates,(function(e){return r("el-option",{key:e.id,attrs:{label:e.title,value:e}})})),1)],1),e.enableOrderCode?r("el-form-item",{attrs:{label:"订单号"}},[r("el-input",{staticStyle:{width:"35%"},model:{value:e.form.orderCode,callback:function(t){e.$set(e.form,"orderCode",t)},expression:"form.orderCode"}})],1):e._e(),r("el-form-item",{attrs:{label:"机器编号",prop:"machineName"}},[r("el-cascader",{staticStyle:{width:"25%"},attrs:{options:e.machines,props:{expandTrigger:"hover"}},model:{value:e.form.machineName,callback:function(t){e.$set(e.form,"machineName",t)},expression:"form.machineName"}})],1),r("el-form-item",{attrs:{label:"接单卡号",prop:"orderNo"}},[r("el-select",{attrs:{placeholder:"选择接单卡号",filterable:!0,"value-key":"id"},on:{change:e.orderOptionChange},model:{value:e.form.orderNo,callback:function(t){e.$set(e.form,"orderNo",t)},expression:"form.orderNo"}},e._l(e.commodities,(function(e){return r("el-option",{key:e.id,attrs:{label:e.col1,value:e}})})),1)],1),r("el-form-item",{attrs:{label:"品名"}},[r("el-input",{staticStyle:{width:"35%"},attrs:{disabled:""},model:{value:e.form.productCode,callback:function(t){e.$set(e.form,"productCode",t)},expression:"form.productCode"}})],1),r("el-form-item",{attrs:{label:"产品名"}},[r("el-input",{staticStyle:{width:"35%"},attrs:{disabled:""},model:{value:e.form.productName,callback:function(t){e.$set(e.form,"productName",t)},expression:"form.productName"}})],1),r("el-form-item",{attrs:{label:"规格"}},[r("el-input",{staticStyle:{width:"35%"},attrs:{disabled:""},model:{value:e.form.specification,callback:function(t){e.$set(e.form,"specification",t)},expression:"form.specification"}})],1),r("el-form-item",{attrs:{label:"纸箱编号"}},[r("el-input",{staticStyle:{width:"35%"},attrs:{disabled:""},model:{value:e.form.boxCode,callback:function(t){e.$set(e.form,"boxCode",t)},expression:"form.boxCode"}})],1),r("el-form-item",{attrs:{label:"SAP代码"}},[r("el-input",{staticStyle:{width:"35%"},attrs:{disabled:""},model:{value:e.form.sapCode,callback:function(t){e.$set(e.form,"sapCode",t)},expression:"form.sapCode"}})],1),r("el-form-item",{attrs:{label:"日期",prop:"selectedDate"}},[r("el-col",{attrs:{span:24}},[r("el-date-picker",{staticStyle:{width:"35%"},attrs:{type:"date",format:"yyyy年MM月dd日","value-format":"yyyyMMdd",placeholder:"选择日期"},model:{value:e.form.selectedDate,callback:function(t){e.$set(e.form,"selectedDate",t)},expression:"form.selectedDate"}})],1)],1),r("el-form-item",{attrs:{label:"箱容量"}},[r("el-input",{staticStyle:{width:"35%"},model:{value:e.form.capacity,callback:function(t){e.$set(e.form,"capacity",t)},expression:"form.capacity"}},[r("el-select",{staticStyle:{width:"100px"},attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:e.form.capacityLabel,callback:function(t){e.$set(e.form,"capacityLabel",t)},expression:"form.capacityLabel"}},[r("el-option",{attrs:{label:"枚/卷",value:"枚/卷"}}),r("el-option",{attrs:{label:"枚/箱",value:"枚/箱"}})],1)],1)],1),r("el-form-item",{attrs:{label:"起始页数"}},[r("el-input-number",{staticStyle:{width:"150px"},attrs:{step:1,size:"medium",min:1,max:5e3},model:{value:e.form.startIndex,callback:function(t){e.$set(e.form,"startIndex",t)},expression:"form.startIndex"}})],1),r("el-form-item",{attrs:{label:"结束页数",prop:"printCount"}},[r("el-input-number",{staticStyle:{width:"150px"},attrs:{step:1,size:"medium",min:1,max:5e3},model:{value:e.form.printCount,callback:function(t){e.$set(e.form,"printCount",t)},expression:"form.printCount"}})],1),r("el-form-item",[r("el-col",{attrs:{span:2}}),r("el-col",{attrs:{span:2}},[r("el-button",{attrs:{icon:"el-icon-printer",type:"primary"},on:{click:function(t){return e.onPreview("form")}}},[e._v("打印")])],1)],1)],1),r("el-dialog",{staticStyle:{padding:"0px 8px"},attrs:{title:"打印",visible:e.previewDialogVisible,"before-close":e.beforeClosePreviewDialog,"close-on-click-modal":!1,width:"600px",center:!0},on:{"update:visible":function(t){e.previewDialogVisible=t}}},[r("span",[r("el-form",{ref:"printForm",attrs:{model:e.printForm,rules:e.rules,"label-width":"120px"}},[r("el-form-item",{attrs:{label:"斑马打印机",prop:"printer"}},[r("el-select",{attrs:{placeholder:"选择斑马打印机",filterable:!0},model:{value:e.printForm.printer,callback:function(t){e.$set(e.printForm,"printer",t)},expression:"printForm.printer"}},e._l(e.printers,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),r("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.showPreviewImg,expression:"showPreviewImg"}],attrs:{label:"缩略图"}},[r("el-image",{staticStyle:{width:"400px"},attrs:{src:e.previewImg}})],1),r("el-form-item",[r("el-row",[r("el-col",{attrs:{span:8}},[r("el-button",{on:{click:function(t){e.previewDialogVisible=!1}}},[e._v("取 消")])],1),r("el-col",{attrs:{span:3}}),r("el-col",{attrs:{span:8}},[r("el-button",{attrs:{icon:"el-icon-printer",type:"primary"},on:{click:function(t){return e.printZpl("printForm")}}},[e._v("打印")])],1)],1)],1)],1)],1)])],1)},o=[],i=(r("a15b"),r("69f8")),l=(r("5c96"),{data:function(){var e=this,t=function(t,r,a){""===r||r<e.form.startIndex?a(new Error("结束页数需要大于起始页数")):a()},r=(new Date).toISOString().split("T")[0].split("-").join("");return{form:{name:"上海福助工业有限公司",orderNo:"",machineName:[],selectedDate:r,startIndex:1,printCount:1,capacity:"",productCode:"",productName:"",sapCode:"",boxCode:"",specification:"",templateId:null,orderCode:"",capacityLabel:"枚/卷"},printForm:{printer:null},templateHtml:"",templateContent:"",previewImg:null,showPreviewImg:!1,enableOrderCode:!1,printers:[],rules:{machineName:[{required:!0,message:"请输入机器编号",trigger:"blur"}],orderNo:[{required:!0,message:"请选择接单卡号",trigger:"change"}],templateId:[{required:!0,message:"请选择模板",trigger:"change"}],printer:[{required:!0,message:"请选择斑马打印机",trigger:"change"}],printCount:[{required:!0,message:"请输入结束页数",trigger:"change"},{validator:t,trigger:"change"}],selectedDate:[{required:!0,message:"请选择日期",trigger:"change"}]},commodities:[],machines:[],templates:[],previewDialogVisible:!1}},created:function(){this.loadMetaData()},methods:{printZpl:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;var r={templateContent:t.templateContent,specification:t.form.specification,machineCode:t.form.machineName[1],selectedDate:t.form.selectedDate,startIndex:t.form.startIndex,printCount:t.form.printCount,capacity:t.form.capacity?t.form.capacity+" "+t.form.capacityLabel:"",sapCode:t.form.sapCode,productCode:t.form.productCode,productName:t.form.productName,printer:t.printForm.printer,orderCode:t.form.orderCode};Object(i["e"])(r).then((function(e){t.previewDialogVisible=!1,t.$message({message:"发送打印命令成功！",type:"success"})}))}))},onPreview:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;var r={templateContent:t.templateContent,specification:t.form.specification,machineCode:t.form.machineName[1],selectedDate:t.form.selectedDate,startIndex:t.form.startIndex,printCount:t.form.printCount,capacity:t.form.capacity?t.form.capacity+" "+t.form.capacityLabel:"",sapCode:t.form.sapCode,productCode:t.form.productCode,productName:t.form.productName};Object(i["d"])(r).then((function(e){t.previewDialogVisible=!0,t.printers=e.data.printers,t.showPreviewImg=null!==e.data.previewImg,t.previewImg="data:image/png;base64,"+e.data.previewImg}))}))},beforeClosePreviewDialog:function(){console.log("call before close dialog"),this.previewDialogVisible=!1},changeTemplate:function(e){this.templateContent=e.content,this.enableOrderCode=e.enableOrderCode},orderOptionChange:function(e){this.form.capacity=e.col6,this.form.productName=e.col4,this.form.productCode=e.col3,this.form.sapCode=e.col2,this.form.specification=e.col5,this.form.boxCode=e.col7},loadMetaData:function(){var e=this;this.listLoading=!0;var t={type:"zebra"};Object(i["a"])(t).then((function(t){console.log(t.data.machines.length),e.commodities=t.data.commodities,e.machines=t.data.machines,e.templates=t.data.templates}))}}}),n=l,s=(r("3c62"),r("2877")),c=Object(s["a"])(n,a,o,!1,null,null,null);t["default"]=c.exports},a15b:function(e,t,r){"use strict";var a=r("23e7"),o=r("44ad"),i=r("fc6a"),l=r("a640"),n=[].join,s=o!=Object,c=l("join",",");a({target:"Array",proto:!0,forced:s||!c},{join:function(e){return n.call(i(this),void 0===e?",":e)}})},aa23:function(e,t,r){}}]);